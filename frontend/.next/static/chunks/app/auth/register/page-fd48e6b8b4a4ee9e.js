(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{532:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},1847:(e,r,t)=>{"use strict";t.d(r,{A:()=>c});var a=t(2115);let s=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},o=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:i="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:r,...l,width:s,height:s,stroke:t,strokeWidth:c?24*Number(n)/Number(s):n,className:o("lucide",i),...!d&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(d)?d:[d]])}),c=(e,r)=>{let t=(0,a.forwardRef)((t,l)=>{let{className:c,...i}=t;return(0,a.createElement)(n,{ref:l,iconNode:r,className:o("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...i})});return t.displayName=s(e),t}},3351:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(5155),s=t(2115),o=t(2619),l=t.n(o),n=t(7910),c=t(6132),i=t(532),d=t(7828),u=t(5917),m=t(7294),h=t(7621);function g(){let[e,r]=(0,s.useState)(!1),[t,o]=(0,s.useState)(!1),[g,f]=(0,s.useState)([]),[p,x]=(0,s.useState)(!0),[b,y]=(0,s.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",branchId:"",agreeToTerms:!1}),{register:w,isLoading:k,error:v,clearError:N}=(0,m.A)();(0,s.useEffect)(()=>{(async()=>{try{let e=await h.A.get("/branches?organizationId=1");f(e.data)}catch(e){console.error("Failed to fetch branches:",e)}finally{x(!1)}})()},[]);let j=async e=>{if(e.preventDefault(),N(),b.password===b.confirmPassword)try{await w({firstName:b.firstName,lastName:b.lastName,email:b.email,password:b.password,branchId:b.branchId?parseInt(b.branchId):void 0})}catch(e){console.error("Registration failed:",e)}},A=e=>{let{name:r,value:t,type:a}=e.target;y({...b,[r]:"checkbox"===a?e.target.checked:t})};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"h-8 w-8 text-white"})})}),(0,a.jsx)("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create your account"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Join GapAnalysis Pro and start your compliance journey"}),(0,a.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Note:"})," Your account will be created with Staff role by default. An administrator will assign your appropriate role after registration."]})})]}),v&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2",children:[(0,a.jsx)(c.A,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:v})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:j,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First name"}),(0,a.jsx)("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",required:!0,value:b.firstName,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last name"}),(0,a.jsx)("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",required:!0,value:b.lastName,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Mwangi"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:b.email,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"john.mwangi@bank.co.ke"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"branchId",className:"block text-sm font-medium text-gray-700",children:"Branch"}),(0,a.jsxs)("select",{id:"branchId",name:"branchId",value:b.branchId,onChange:A,disabled:p,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,a.jsx)("option",{value:"",children:p?"Loading branches...":"Select a branch"}),g.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",e.region]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("input",{id:"password",name:"password",type:e?"text":"password",autoComplete:"new-password",required:!0,value:b.password,onChange:A,className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Create a strong password"}),(0,a.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>r(!e),children:e?(0,a.jsx)(i.A,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:t?"text":"password",autoComplete:"new-password",required:!0,value:b.confirmPassword,onChange:A,className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your password"}),(0,a.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>o(!t),children:t?(0,a.jsx)(i.A,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"agreeToTerms",name:"agreeToTerms",type:"checkbox",required:!0,checked:b.agreeToTerms,onChange:A,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsxs)("label",{htmlFor:"agreeToTerms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",(0,a.jsx)(l(),{href:"/terms",className:"text-blue-600 hover:text-blue-500",children:"Terms of Service"})," ","and"," ",(0,a.jsx)(l(),{href:"/privacy",className:"text-blue-600 hover:text-blue-500",children:"Privacy Policy"})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("button",{type:"submit",disabled:k,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-500 group-hover:text-blue-400"})}),k?"Creating account...":"Create account"]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,a.jsx)(l(),{href:"/auth/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in"})]})})]})]})})}},5917:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6132:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6813:(e,r,t)=>{Promise.resolve().then(t.bind(t,3351))},7294:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>d,A:()=>i});var a=t(5155),s=t(2115),o=t(7621);let l={async login(e){let r=await o.A.post("/auth/login",e),t=r.data.accessToken,a=r.data.refreshToken;return t&&localStorage.setItem("accessToken",t),a&&localStorage.setItem("refreshToken",a),{user:r.data.user,accessToken:t||"",refreshToken:a||""}},async loginToOrganization(e){let r=await o.A.post("/auth/login/organization",e),t=r.data.accessToken,a=r.data.refreshToken;return t&&localStorage.setItem("accessToken",t),a&&localStorage.setItem("refreshToken",a),{user:r.data.user,accessToken:t||"",refreshToken:a||""}},async loginByDomain(e){let r=await o.A.post("/auth/login/domain",e),t=r.data.accessToken,a=r.data.refreshToken;return t&&localStorage.setItem("accessToken",t),a&&localStorage.setItem("refreshToken",a),{user:r.data.user,accessToken:t||"",refreshToken:a||""}},getOrganizations:async()=>(await o.A.get("/organizations")).data,getOrganizationByDomain:async e=>(await o.A.get("/organizations/domain/".concat(e))).data,async register(e){let r=await o.A.post("/auth/register",e),t=r.data.accessToken,a=r.data.refreshToken;return t&&localStorage.setItem("accessToken",t),a&&localStorage.setItem("refreshToken",a),{user:r.data.user,accessToken:t||"",refreshToken:a||""}},async logout(){try{await o.A.post("/auth/logout")}catch(e){e&&"object"==typeof e&&"response"in e&&e.response&&"object"==typeof e.response&&"status"in e.response&&404===e.response.status?console.log("Logout endpoint not available, proceeding with client-side logout"):console.error("Logout error:",e)}finally{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}},getCurrentUser:async()=>(await o.A.get("/auth/me")).data,async refreshToken(){let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token available");let{accessToken:r}=(await o.A.post("/auth/refresh",{refreshToken:e})).data;return localStorage.setItem("accessToken",r),{accessToken:r}},isAuthenticated:()=>!!localStorage.getItem("accessToken"),getAccessToken:()=>localStorage.getItem("accessToken"),getRefreshToken:()=>localStorage.getItem("refreshToken")};var n=t(63);let c=(0,s.createContext)(void 0),i=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:r}=e,[t,o]=(0,s.useState)(null),[i,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),h=(0,n.useRouter)();(0,s.useEffect)(()=>{(async()=>{try{if(l.isAuthenticated()){let e=await l.getCurrentUser();o(e),"SUPER_ADMIN"===e.role&&"/dashboard"===window.location.pathname&&h.push("/dashboard/super-admin")}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}finally{d(!1)}})()},[h]);let g=async e=>{try{d(!0),m(null);let r=await l.login(e);o(r.user),"SUPER_ADMIN"===r.user.role?h.push("/dashboard/super-admin"):h.push("/dashboard")}catch(e){var r,t;throw m((null==(t=e.response)||null==(r=t.data)?void 0:r.message)||"Login failed. Please try again."),e}finally{d(!1)}},f=async e=>{try{d(!0),m(null);let r=await l.register(e);o(r.user),"SUPER_ADMIN"===r.user.role?h.push("/dashboard/super-admin"):h.push("/dashboard")}catch(e){var r,t;throw m((null==(t=e.response)||null==(r=t.data)?void 0:r.message)||"Registration failed. Please try again."),e}finally{d(!1)}},p=async()=>{try{await l.logout()}catch(e){console.error("Logout error:",e)}finally{o(null),h.push("/auth/login")}};return(0,a.jsx)(c.Provider,{value:{user:t,isLoading:i,isAuthenticated:!!t,login:g,register:f,logout:p,error:u,clearError:()=>{m(null)}},children:r})}},7621:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var a=t(5125);let s=a.A.create({baseURL:"http://localhost:3000",withCredentials:!0,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let r=localStorage.getItem("accessToken");r&&(e.headers.Authorization="Bearer ".concat(r))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var r;let t=e.config;if((null==(r=e.response)?void 0:r.status)===401&&!t._retry){t._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{accessToken:r}=(await a.A.post("".concat("http://localhost:3000","/auth/refresh"),{refreshToken:e},{withCredentials:!0})).data;return localStorage.setItem("accessToken",r),t.headers.Authorization="Bearer ".concat(r),s(t)}}catch(e){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/auth/login"}}return Promise.reject(e)});let o=s},7828:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7910:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}},e=>{e.O(0,[977,619,441,255,358],()=>e(e.s=6813)),_N_E=e.O()}]);